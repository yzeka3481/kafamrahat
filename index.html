<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kafam Rahat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            /* Daha yumuÅŸak, gÃ¶z yormayan arka plan */
            background: #e5e7eb; /* slate-200 tonunda */
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }
        .card {
            box-shadow:
                0 8px 12px -4px rgba(15, 23, 42, 0.06),
                0 2px 4px -2px rgba(15, 23, 42, 0.04);
        }
        /* Saf beyaz yerine kÄ±rÄ±k beyaz kullan */
        .bg-white {
            background-color: #fdfcf7 !important;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
<div class="max-w-xl mx-auto w-full px-4 py-6 flex-1 flex flex-col">
    <!-- Ãœst Bar -->
    <header class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-2">
            <div class="w-9 h-9 rounded-2xl bg-sky-500 flex items-center justify-center text-white text-xl">
                ğŸ§ 
            </div>
            <div>
                <div class="text-sm font-semibold text-slate-800">Kafam Rahat</div>
                <div class="text-[11px] text-slate-500">Zihinsel yÃ¼k asistanÄ±</div>
            </div>
        </div>
        <button class="relative text-slate-500" title="Bildirimler (simÃ¼lasyon)">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none"
                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                <path stroke-linecap="round" stroke-linejoin="round"
                      d="M14.857 17.657A2 2 0 1112 19a2 2 0 012.857-1.343zM5.5 9.5A6.5 6.5 0 0118.5 9.5c0 3.21.964 4.447 1.553 5.027a1 1 0 01-.707 1.707H4.654a1 1 0 01-.707-1.707C4.536 13.947 5.5 12.71 5.5 9.5z" />
            </svg>
        </button>
    </header>

    <main class="flex-1 flex flex-col">
        <!-- GÃ–RÃœNÃœM: BUGÃœN -->
        <div id="view-today" class="flex-1 flex flex-col gap-4">
            <!-- KafamÄ± BoÅŸalt AlanÄ± -->
            <section class="card bg-white rounded-2xl p-4">
                <h1 class="text-base font-semibold text-slate-800 mb-1">KafamÄ± boÅŸalt</h1>
                <p class="text-xs text-slate-500 mb-3">
                    AklÄ±na gelenleri yaz, parÃ§alara biz ayÄ±ralÄ±m.
                </p>

                <textarea
                    id="brainDump"
                    rows="3"
                    class="w-full border border-slate-200 rounded-xl text-sm p-3 mb-3 focus:outline-none focus:ring-2 focus:ring-sky-400 focus:border-transparent bg-slate-50"
                    placeholder="AkÅŸam eve giderken sÃ¼t al, Ali'nin spor Ã§antasÄ±nÄ± hazÄ±rla, diÅŸÃ§iyi ara..."
                ></textarea>

                <div class="flex items-center justify-between gap-3">
                    <button
                        disabled
                        class="flex items-center gap-1 text-xs text-slate-400 border border-slate-200 rounded-xl px-3 py-1.5 cursor-not-allowed bg-slate-50">
                        <span>ğŸ¤</span>
                        <span>Sesle ekle (yakÄ±nda)</span>
                    </button>

                    <button
                        id="processBrainDump"
                        class="ml-auto bg-sky-500 text-white text-xs font-medium px-4 py-2 rounded-xl hover:bg-sky-600 active:scale-[0.98] transition">
                        Ä°ÅŸle ve listeye ekle
                    </button>
                </div>

                <p class="mt-2 text-[11px] text-slate-400">
                    Ä°pucu: CÃ¼mleleri <span class="font-semibold">virgÃ¼l</span>, <span class="font-semibold">satÄ±r sonu</span>
                    veya <span class="font-semibold">noktalÄ± virgÃ¼lle</span> ayÄ±rabilirsin.
                </p>
            </section>

            <!-- BugÃ¼n Listesi -->
            <section class="flex-1 flex flex-col">
                <div class="flex items-baseline justify-between mb-2">
                    <h2 class="text-sm font-semibold text-slate-800">BugÃ¼n yapÄ±lacaklar</h2>
                    <button id="clearAll"
                            class="text-[11px] text-slate-400 hover:text-rose-500 hover:underline">
                        Hepsini temizle
                    </button>
                </div>

                <div
                    id="emptyState"
                    class="rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-6 text-center text-xs text-slate-500">
                    BugÃ¼n iÃ§in gÃ¶rev yok. YukarÄ±ya birkaÃ§ ÅŸey yazÄ±p
                    <span class="font-semibold text-slate-700">Ä°ÅŸle ve listeye ekle</span> butonuna basabilirsin.
                </div>

                <div id="taskList" class="space-y-3 mt-1 hidden"></div>
            </section>
        </div>

        <!-- GÃ–RÃœNÃœM: Ã–ZET -->
        <div id="view-summary" class="flex-1 flex flex-col gap-4 hidden">
            <section class="card bg-white rounded-2xl p-4">
                <h1 class="text-base font-semibold text-slate-800 mb-1">Genel durum</h1>
                <p class="text-xs text-slate-500 mb-3">
                    BugÃ¼ne kadar eklediÄŸin gÃ¶revlerin hÄ±zlÄ± Ã¶zeti.
                </p>

                <div class="grid grid-cols-3 gap-2 mt-3 text-center text-xs">
                    <div class="rounded-xl bg-slate-50 px-2 py-3">
                        <div class="text-[11px] text-slate-500">Toplam</div>
                        <div id="summary-total" class="text-lg font-semibold text-slate-800">0</div>
                    </div>
                    <div class="rounded-xl bg-slate-50 px-2 py-3">
                        <div class="text-[11px] text-slate-500">Bekleyen</div>
                        <div id="summary-pending" class="text-lg font-semibold text-amber-600">0</div>
                    </div>
                    <div class="rounded-xl bg-slate-50 px-2 py-3">
                        <div class="text-[11px] text-slate-500">Tamamlanan</div>
                        <div id="summary-done" class="text-lg font-semibold text-emerald-600">0</div>
                    </div>
                </div>
            </section>

            <section class="card bg-white rounded-2xl p-4">
                <div class="flex items-center justify-between mb-2">
                    <h2 class="text-sm font-semibold text-slate-800">Alanlara gÃ¶re daÄŸÄ±lÄ±m</h2>
                </div>
                <div class="overflow-hidden rounded-xl border border-slate-100 bg-slate-50">
                    <table class="min-w-full text-[11px]">
                        <thead class="bg-slate-100 text-slate-500">
                        <tr>
                            <th class="px-3 py-2 text-left">Alan</th>
                            <th class="px-3 py-2 text-right">GÃ¶rev</th>
                        </tr>
                        </thead>
                        <tbody id="summary-category-list" class="text-slate-700">
                        <tr>
                            <td class="px-3 py-2 text-slate-400" colspan="2">
                                HenÃ¼z gÃ¶rev yok.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="card bg-white rounded-2xl p-4">
                <h2 class="text-sm font-semibold text-slate-800 mb-1">KÄ±sa yorum</h2>
                <p id="summary-comment" class="text-xs text-slate-500">
                    GÃ¶rev eklemeye baÅŸladÄ±ÄŸÄ±nda burada haftalÄ±k yorumun gÃ¶rÃ¼necek.
                </p>
            </section>
        </div>

        <!-- GÃ–RÃœNÃœM: AYARLAR -->
        <div id="view-settings" class="flex-1 flex flex-col gap-4 hidden">
            <section class="card bg-white rounded-2xl p-4">
                <h1 class="text-base font-semibold text-slate-800 mb-1">Genel ayarlar</h1>
                <p class="text-xs text-slate-500 mb-3">
                    UygulamanÄ±n davranÄ±ÅŸÄ±nÄ± kendine gÃ¶re ayarlayabilirsin.
                </p>

                <div class="space-y-3 text-xs">
                    <label class="flex items-start gap-3">
                        <input id="setting-sample-tasks" type="checkbox"
                               class="mt-[2px] w-3.5 h-3.5 rounded border-slate-300 text-sky-500" />
                        <div>
                            <div class="font-semibold text-slate-800 text-xs">
                                BaÅŸlangÄ±Ã§ta Ã¶rnek gÃ¶rev ekle
                            </div>
                            <div class="text-[11px] text-slate-500">
                                Uygulama aÃ§Ä±ldÄ±ÄŸÄ±nda demo olarak birkaÃ§ gÃ¶rev gelsin.
                            </div>
                        </div>
                    </label>

                    <label class="flex items-start gap-3">
                        <input id="setting-compact-mode" type="checkbox"
                               class="mt-[2px] w-3.5 h-3.5 rounded border-slate-300 text-sky-500" />
                        <div>
                            <div class="font-semibold text-slate-800 text-xs">
                                GÃ¶rev kartlarÄ±nÄ± sÄ±kÄ± gÃ¶ster
                            </div>
                            <div class="text-[11px] text-slate-500">
                                Daha az boÅŸluk, daha Ã§ok gÃ¶rev gÃ¶rmek iÃ§in.
                            </div>
                        </div>
                    </label>
                </div>
            </section>

            <section class="card bg-white rounded-2xl p-4">
                <h2 class="text-sm font-semibold text-slate-800 mb-1">Tema (sadece gÃ¶rÃ¼nÃ¼m)</h2>
                <p class="text-xs text-slate-500 mb-3">
                    Bu Ã¶rnek sÃ¼rÃ¼mde tema deÄŸiÅŸimi sadece arka plan tonunu deÄŸiÅŸtirir.
                </p>

                <div class="flex gap-2 text-xs">
                    <button id="theme-light"
                            class="flex-1 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-slate-700">
                        AÃ§Ä±k tema
                    </button>
                    <button id="theme-soft"
                            class="flex-1 rounded-xl border border-sky-100 bg-sky-50 px-3 py-2 text-slate-700">
                        YumuÅŸak mavi
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- Alt MenÃ¼ -->
    <footer class="border-t border-slate-200 pt-2 mt-4">
        <div class="flex justify-around text-[11px] text-slate-500 pb-1">
            <button id="nav-today" class="flex flex-col items-center text-sky-600">
                <span class="text-lg">ğŸ </span>
                <span>BugÃ¼n</span>
            </button>
            <button id="nav-summary" class="flex flex-col items-center opacity-60">
                <span class="text-lg">ğŸ“Š</span>
                <span>Ã–zet</span>
            </button>
            <button id="nav-settings" class="flex flex-col items-center opacity-60">
                <span class="text-lg">âš™ï¸</span>
                <span>Ayarlar</span>
            </button>
        </div>
    </footer>
</div>

<script>
(function () {
    // DOM Ã¶geleri
    const brainDump      = document.getElementById('brainDump');
    const processBtn     = document.getElementById('processBrainDump');
    const taskListEl     = document.getElementById('taskList');
    const emptyStateEl   = document.getElementById('emptyState');
    const clearAllBtn    = document.getElementById('clearAll');

    const viewToday      = document.getElementById('view-today');
    const viewSummary    = document.getElementById('view-summary');
    const viewSettings   = document.getElementById('view-settings');

    const navToday       = document.getElementById('nav-today');
    const navSummary     = document.getElementById('nav-summary');
    const navSettings    = document.getElementById('nav-settings');

    const summaryTotalEl     = document.getElementById('summary-total');
    const summaryPendingEl   = document.getElementById('summary-pending');
    const summaryDoneEl      = document.getElementById('summary-done');
    const summaryCategoryEl  = document.getElementById('summary-category-list');
    const summaryCommentEl   = document.getElementById('summary-comment');

    const sampleToggle       = document.getElementById('setting-sample-tasks');
    const compactToggle      = document.getElementById('setting-compact-mode');
    const themeLightBtn      = document.getElementById('theme-light');
    const themeSoftBtn       = document.getElementById('theme-soft');

    let tasks = [];
    let completedTasks = [];
    let settings = loadSettings();

    // AyarlarÄ± oku / yaz
    function loadSettings() {
        try {
            const raw = localStorage.getItem('kafamRahatSettings');
            if (!raw) {
                return {
                    sampleTasks: true,
                    compactMode: false,
                    theme: 'light'
                };
            }
            const parsed = JSON.parse(raw);
            return {
                sampleTasks: parsed.sampleTasks !== undefined ? parsed.sampleTasks : true,
                compactMode: !!parsed.compactMode,
                theme: parsed.theme || 'light'
            };
        } catch (e) {
            return {
                sampleTasks: true,
                compactMode: false,
                theme: 'light'
            };
        }
    }

    function saveSettings() {
        localStorage.setItem('kafamRahatSettings', JSON.stringify(settings));
    }

    function applyTheme() {
        if (settings.theme === 'soft') {
            document.body.style.background = '#e0f2fe'; // soft mavi (sky-100)
        } else {
            document.body.style.background = '#e5e7eb'; // varsayÄ±lan yumuÅŸak gri
        }
    }

    function updateSettingsUI() {
        if (sampleToggle) sampleToggle.checked = !!settings.sampleTasks;
        if (compactToggle) compactToggle.checked = !!settings.compactMode;
        applyTheme();
    }

    // Kategori tahmini (basit)
    function guessCategory(text) {
        const t = text.toLowerCase();
        if (t.includes('okul') || t.includes('Ã¶dev') || t.includes('spor Ã§antasÄ±') || t.includes('ders')) {
            return { icon: 'ğŸ’', label: 'Ã‡ocuk' };
        }
        if (t.includes('mail') || t.includes('toplantÄ±') || t.includes('rapor') || t.includes('sunum')) {
            return { icon: 'ğŸ’¼', label: 'Ä°ÅŸ' };
        }
        if (t.includes('randevu') || t.includes('doktor') || t.includes('ilaÃ§') || t.includes('tahlil')) {
            return { icon: 'â¤ï¸', label: 'SaÄŸlÄ±k' };
        }
        if (t.includes('market') || t.includes('sÃ¼t') || t.includes('ekmek') || t.includes('Ã§Ã¶p')
            || t.includes('bulaÅŸÄ±k') || t.includes('Ã§amaÅŸÄ±r')) {
            return { icon: 'ğŸ ', label: 'Ev' };
        }
        return { icon: 'âœ…', label: 'Genel' };
    }

    // Ã–zet ekranÄ±nÄ± gÃ¼ncelle
    function updateSummary() {
        if (!summaryTotalEl) return;

        const totalPending = tasks.length;
        const totalDone    = completedTasks.length;
        const total        = totalPending + totalDone;

        summaryTotalEl.textContent   = total;
        summaryPendingEl.textContent = totalPending;
        summaryDoneEl.textContent    = totalDone;

        const all = tasks.concat(completedTasks);
        const baseCategories = ['Ev', 'Ä°ÅŸ', 'Ã‡ocuk', 'SaÄŸlÄ±k', 'Genel'];
        const counts = {
            'Ev': 0,
            'Ä°ÅŸ': 0,
            'Ã‡ocuk': 0,
            'SaÄŸlÄ±k': 0,
            'Genel': 0
        };

        all.forEach(t => {
            const label = t.category.label;
            if (!counts[label] && counts[label] !== 0) {
                counts[label] = 0;
            }
            counts[label]++;
        });

        summaryCategoryEl.innerHTML = '';
        let anyData = false;
        baseCategories.forEach(label => {
            const count = counts[label] || 0;
            if (count > 0) anyData = true;
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="px-3 py-2">${label}</td>
                <td class="px-3 py-2 text-right">${count}</td>
            `;
            summaryCategoryEl.appendChild(tr);
        });

        if (!anyData) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="px-3 py-2 text-slate-400" colspan="2">
                    HenÃ¼z gÃ¶rev yok.
                </td>
            `;
            summaryCategoryEl.appendChild(tr);
        }

        if (total === 0) {
            summaryCommentEl.textContent =
                'GÃ¶rev eklemeye baÅŸladÄ±ÄŸÄ±nda burada haftalÄ±k yorumun gÃ¶rÃ¼necek.';
        } else {
            // En Ã§ok hangi alan kullanÄ±lmÄ±ÅŸ?
            let topCat = null;
            let topCount = 0;
            Object.keys(counts).forEach(label => {
                if (counts[label] > topCount) {
                    topCount = counts[label];
                    topCat = label;
                }
            });

            if (topCat) {
                summaryCommentEl.textContent =
                    `Åu ana kadar en Ã§ok "${topCat}" alanÄ±nda gÃ¶rev biriktirmiÅŸsin. ` +
                    `Dilersen bu alandaki iÅŸleri haftaya biraz daÄŸÄ±tarak zihinsel yÃ¼kÃ¼nÃ¼ hafifletebilirsin.`;
            } else {
                summaryCommentEl.textContent =
                    'GÃ¶revlerin daÄŸÄ±lÄ±mÄ± oldukÃ§a dengeli gÃ¶rÃ¼nÃ¼yor. BÃ¶yle devam!';
            }
        }
    }

    // GÃ¶revleri ekrana bas
    function renderTasks() {
        if (tasks.length === 0) {
            emptyStateEl.classList.remove('hidden');
            taskListEl.classList.add('hidden');
            updateSummary();
            return;
        }

        emptyStateEl.classList.add('hidden');
        taskListEl.classList.remove('hidden');
        taskListEl.innerHTML = '';

        tasks.forEach((task, index) => {
            const wrapper = document.createElement('div');
            const paddingClass = settings.compactMode ? 'p-2' : 'p-3';
            wrapper.className = `card bg-white rounded-2xl ${paddingClass} border border-slate-100 flex items-start gap-3`;

            const icon = document.createElement('div');
            icon.className = 'w-8 h-8 rounded-xl bg-slate-100 flex items-center justify-center text-lg';
            icon.textContent = task.category.icon;

            const content = document.createElement('div');
            content.className = 'flex-1 min-w-0';

            const title = document.createElement('div');
            title.className = 'text-sm text-slate-800';
            title.textContent = task.text;

            const meta = document.createElement('div');
            meta.className = 'mt-1 flex items-center gap-2 text-[11px] text-slate-500';

            const cat = document.createElement('span');
            cat.textContent = task.category.label;

            const duration = document.createElement('span');
            duration.textContent = task.durationLabel;
            duration.className = 'px-2 py-[2px] rounded-full bg-slate-100 text-[10px]';

            meta.appendChild(cat);
            meta.appendChild(duration);

            const actions = document.createElement('div');
            actions.className = 'mt-2 flex items-center gap-2 text-[11px]';

            const doneBtn = document.createElement('button');
            doneBtn.textContent = 'TamamlandÄ±';
            doneBtn.className =
                'px-2 py-[3px] rounded-lg bg-emerald-500 text-white hover:bg-emerald-600 transition';
            doneBtn.addEventListener('click', () => {
                // Tamamlananlar listesini tut
                completedTasks.push({
                    ...task,
                    completedAt: new Date().toISOString()
                });
                tasks.splice(index, 1);
                renderTasks();
            });

            const snoozeBtn = document.createElement('button');
            snoozeBtn.textContent = 'Sonra';
            snoozeBtn.className =
                'px-2 py-[3px] rounded-lg border border-slate-200 text-slate-500 hover:border-slate-300 transition';
            snoozeBtn.addEventListener('click', () => {
                wrapper.classList.add('opacity-60');
            });

            actions.appendChild(doneBtn);
            actions.appendChild(snoozeBtn);

            content.appendChild(title);
            content.appendChild(meta);
            content.appendChild(actions);

            wrapper.appendChild(icon);
            wrapper.appendChild(content);

            taskListEl.appendChild(wrapper);
        });

        updateSummary();
    }

    // Metinden gÃ¶rev Ã¼ret
    function addTasksFromText(text) {
        if (!text) return;
        const rawParts = text.split(/[\n,;]+/);
        rawParts.forEach(part => {
            const t = part.trim();
            if (!t) return;
            const category = guessCategory(t);
            const len = t.length;
            let durationLabel = '5 dk';
            if (len < 25) durationLabel = '2 dk';
            else if (len > 60) durationLabel = '15 dk+';

            tasks.push({
                text: t,
                category,
                durationLabel,
                createdAt: new Date().toISOString()
            });
        });
        renderTasks();
    }

    // GÃ¶rÃ¼nÃ¼m deÄŸiÅŸtirme
    function setActiveView(view) {
        // GÃ¶rÃ¼nÃ¼mleri gÃ¶ster / gizle
        viewToday.classList.toggle('hidden', view !== 'today');
        viewSummary.classList.toggle('hidden', view !== 'summary');
        viewSettings.classList.toggle('hidden', view !== 'settings');

        // Alt menÃ¼ sÄ±nÄ±flarÄ±
        const activeClass = 'text-sky-600';
        const inactiveClass = 'opacity-60';

        [navToday, navSummary, navSettings].forEach(btn => {
            btn.classList.remove(activeClass, inactiveClass);
            btn.classList.add('flex', 'flex-col', 'items-center');
        });

        if (view === 'today') {
            navToday.classList.add(activeClass);
            navSummary.classList.add(inactiveClass);
            navSettings.classList.add(inactiveClass);
        } else if (view === 'summary') {
            navSummary.classList.add(activeClass);
            navToday.classList.add(inactiveClass);
            navSettings.classList.add(inactiveClass);
            updateSummary();
        } else if (view === 'settings') {
            navSettings.classList.add(activeClass);
            navToday.classList.add(inactiveClass);
            navSummary.classList.add(inactiveClass);
        }
    }

    // Event baÄŸlama
    processBtn.addEventListener('click', () => {
        const value = brainDump.value.trim();
        if (!value) return;
        addTasksFromText(value);
        brainDump.value = '';
        brainDump.focus();
    });

    clearAllBtn.addEventListener('click', () => {
        if (tasks.length === 0) return;
        const ok = confirm('BugÃ¼nkÃ¼ tÃ¼m gÃ¶revleri silmek istiyor musun? (Tamamlananlara eklenecek)');
        if (!ok) return;
        // Hepsini tamamlanmÄ±ÅŸ gibi say
        tasks.forEach(task => {
            completedTasks.push({
                ...task,
                completedAt: new Date().toISOString()
            });
        });
        tasks = [];
        renderTasks();
    });

    navToday.addEventListener('click', () => setActiveView('today'));
    navSummary.addEventListener('click', () => setActiveView('summary'));
    navSettings.addEventListener('click', () => setActiveView('settings'));

    if (sampleToggle) {
        sampleToggle.addEventListener('change', () => {
            settings.sampleTasks = sampleToggle.checked;
            saveSettings();
        });
    }

    if (compactToggle) {
        compactToggle.addEventListener('change', () => {
            settings.compactMode = compactToggle.checked;
            saveSettings();
            renderTasks();
        });
    }

    if (themeLightBtn) {
        themeLightBtn.addEventListener('click', () => {
            settings.theme = 'light';
            saveSettings();
            applyTheme();
        });
    }

    if (themeSoftBtn) {
        themeSoftBtn.addEventListener('click', () => {
            settings.theme = 'soft';
            saveSettings();
            applyTheme();
        });
    }

    // BaÅŸlangÄ±Ã§: ayarlarÄ± UI'a uygula
    updateSettingsUI();

    // BaÅŸlangÄ±Ã§ta Ã¶rnek gÃ¶rev ekle
    if (settings.sampleTasks) {
        addTasksFromText("Eve giderken sÃ¼t al, Ali'nin spor Ã§antasÄ±nÄ± hazÄ±rla");
    } else {
        renderTasks();
    }

    // Ä°lk gÃ¶rÃ¼nÃ¼m: BugÃ¼n
    setActiveView('today');
})();
</script>
</body>
</html>
